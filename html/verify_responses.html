
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>verify_responses</title><meta name="generator" content="MATLAB 9.3"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2018-10-20"><meta name="DC.source" content="verify_responses.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">verifiy_responses.m</a></li><li><a href="#2">Data Cleaning</a></li><li><a href="#3">q1 response</a></li></ul></div><h2 id="1">verifiy_responses.m</h2><p>Choose dampned natural frequency and zeta and the  approximated reponses will be plotted on measured data</p><pre class="codeinput">close <span class="string">all</span>;
clear <span class="string">all</span>;

<span class="comment">% Requires natural frequency for responses, determine in data_aquisition.m</span>
<span class="comment">% and determine_zeta.m</span>

q1_wd = 0.906702*2*pi; <span class="comment">%  [rad/s] dampned natural frequency of q1 response</span>
zeta_1 = 0.0130;    <span class="comment">% zeta for q1 response</span>
q1_wn = q1_wd/(sqrt(1-zeta_1^2)); <span class="comment">%   [rad/s] natural frequency for q1 response</span>

q2_wd = 1.08128*2*pi; <span class="comment">%  [rad/s] dampned natural frequency of q2 response</span>
zeta_2 = 0.0545;   <span class="comment">% zeta for q2 response</span>
q2_wn = q2_wd/(sqrt(1-zeta_2^2)) <span class="comment">%  [rad/s] natural frequency for q2 response</span>

<span class="comment">% file name for q1</span>
file_name_q1 = <span class="string">'C:\Users\Henry\Desktop\Skripsie\Feedback-Control-of-Robotic-Gymnast-MCU\q1_response1.csv'</span>;
<span class="comment">% file name for q2</span>
file_name_q2 = <span class="string">'C:\Users\Henry\Desktop\Skripsie\Feedback-Control-of-Robotic-Gymnast-MCU\q2_response2.csv'</span>;

<span class="comment">% time increments</span>
time_steps = 1e-3;

<span class="comment">% response information</span>
system_info_q1 = csvread(file_name_q1,2);
system_info_q2 = csvread(file_name_q2,2);

<span class="comment">% time for q1</span>
time_q1 = system_info_q1(1:end,1)./1000;
<span class="comment">% time for q2</span>
time_q2 = system_info_q2(1:end,1)./1000;

<span class="comment">% q1 response</span>
q1 = (system_info_q1(1:end,2)-2195).*0.00153;

<span class="comment">% q2 response</span>
q2 = system_info_q2(1:end,3).*0.01570796326/2;

tau = system_info_q1(1:end,4);

<span class="comment">% three point central difference</span>
q1dot = cent_diff_n(q1,time_steps,3);
q2dot = cent_diff_n(q2,time_steps,3);
q1dotdot = cent_diff_n(q1dot,time_steps,3);
q2dotdot = cent_diff_n(q2dot,time_steps,3);
</pre><pre class="codeoutput">
q2_wn =

    6.8040

</pre><h2 id="2">Data Cleaning</h2><p>Removing points outside boundary:</p><pre class="codeinput">i = find(q1(:,1) &gt; 0.6*pi);
j = find(q1(:,1) &lt; -0.6*pi);
q1(i) = 0;
q1(j) = 0;

<span class="comment">% Removing points outside boundary:</span>
i = find(q2(:,1) &gt; 2*pi);
j = find(q2(:,1) &lt; -2*pi);
q2(i) = 0;
q2(j) = 0;

<span class="comment">% smoothing function to remove any noise</span>
q1 = smooth(q1);
q2 = smooth(q2);
</pre><h2 id="3">q1 response</h2><pre class="codeinput">figure(1);
plot(time_q1,q1,<span class="string">'.r'</span>);
title(<span class="string">'System Response from Initial Conditions with $\phi = 0 $ '</span>,<span class="string">'Interpreter'</span>,<span class="string">'latex'</span>,<span class="string">'FontSize'</span>,12)
yticks([-2*pi -pi 0 pi 2*pi]);
ylabel(<span class="string">'$\theta$ [rad]'</span>,<span class="string">'Interpreter'</span>,<span class="string">'latex'</span>,<span class="string">'FontSize'</span>,12);
xlabel(<span class="string">'time [ms]'</span>,<span class="string">'Interpreter'</span>,<span class="string">'latex'</span>,<span class="string">'FontSize'</span>,12);
yticklabels({<span class="string">'-1.5\pi'</span>,<span class="string">'-\pi'</span>,<span class="string">'-0.5\pi'</span>,<span class="string">'0'</span>,<span class="string">'0.5\pi'</span>,<span class="string">'\pi'</span>,<span class="string">'1.5\pi'</span>})
yticks([-1.5*pi -1*pi -0.5*pi 0 0.5*pi 1*pi 1.5*pi]);
grid <span class="string">on</span>
xt = get(gca, <span class="string">'XTick'</span>);
set(gca, <span class="string">'FontSize'</span>, 12);
yt = get(gca, <span class="string">'YTick'</span>);
set(gca, <span class="string">'FontSize'</span>, 12);
hold <span class="string">on</span>

disp(<span class="string">'Click on starting point and steady state point'</span>);
[xx,yy] = ginput(2);



time_q1 = linspace(xx(1),xx(2),1000);
approximate_response = -yy(1)*exp(-1.*zeta_1.*q1_wn.*time_q1).*(cos(q1_wd.*time_q1));

plot(time_q1, approximate_response,<span class="string">'-b'</span>,<span class="string">'LineWidth'</span>,1);
<span class="comment">% hold on</span>
<span class="comment">% plot(time_q1.*1000, -pi/2.*exp(-1*zeta_1*q1_wn*time_q1.*1000),'-g','LineWidth',2);</span>
<span class="comment">% legend('Expertimental Data', 'Approximated Response','Approximated Decay Function')</span>
<span class="comment">%</span>
<span class="comment">%</span>
<span class="comment">% % q2 response</span>
<span class="comment">%</span>
figure(2)
plot(time_q2.*1000,q2,<span class="string">'b.'</span>);
title(<span class="string">'System Response from Initial Conditions with $\theta = 0 $ '</span>,<span class="string">'Interpreter'</span>,<span class="string">'latex'</span>,<span class="string">'FontSize'</span>,12)
yticks([-2*pi -pi 0 pi 2*pi]);
ylabel(<span class="string">'$\phi$ [rad]'</span>,<span class="string">'Interpreter'</span>,<span class="string">'latex'</span>,<span class="string">'FontSize'</span>,12);
xlabel(<span class="string">'time [ms]'</span>,<span class="string">'Interpreter'</span>,<span class="string">'latex'</span>,<span class="string">'FontSize'</span>,12);
yticklabels({<span class="string">'-1.5\pi'</span>,<span class="string">'-\pi'</span>,<span class="string">'-0.5\pi'</span>,<span class="string">'0'</span>,<span class="string">'0.5\pi'</span>,<span class="string">'\pi'</span>,<span class="string">'1.5\pi'</span>})
yticks([-1.5*pi -1*pi -0.5*pi 0 0.5*pi 1*pi 1.5*pi]);
grid <span class="string">on</span>
xt = get(gca, <span class="string">'XTick'</span>);
set(gca, <span class="string">'FontSize'</span>, 12);
yt = get(gca, <span class="string">'YTick'</span>);
set(gca, <span class="string">'FontSize'</span>, 12);
hold <span class="string">on</span>

time_q2 = linspace(0,8,8000);
approximate_response = -pi/2.*exp(-1.*zeta_2.*q2_wn.*time_q2).*(cos(q2_wd.*time_q2));

plot(time_q2.*1000, approximate_response,<span class="string">'-r'</span>,<span class="string">'LineWidth'</span>,1);

plot(time_q2.*1000, -pi/2.*exp(-1*zeta_2*q2_wn*time_q2),<span class="string">'-g'</span>,<span class="string">'LineWidth'</span>,2);
legend(<span class="string">'Expertimental Data'</span>, <span class="string">'Approximated Response'</span>,<span class="string">'Approximated Decay Function'</span>)
</pre><pre class="codeoutput">Click on starting point and steady state point
</pre><img vspace="5" hspace="5" src="verify_responses_01.png" alt=""> <img vspace="5" hspace="5" src="verify_responses_02.png" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2017b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% verifiy_responses.m
% Choose dampned natural frequency and zeta
% and the  approximated reponses will be plotted
% on measured data


close all;
clear all;

% Requires natural frequency for responses, determine in data_aquisition.m
% and determine_zeta.m

q1_wd = 0.906702*2*pi; %  [rad/s] dampned natural frequency of q1 response 
zeta_1 = 0.0130;    % zeta for q1 response
q1_wn = q1_wd/(sqrt(1-zeta_1^2)); %   [rad/s] natural frequency for q1 response

q2_wd = 1.08128*2*pi; %  [rad/s] dampned natural frequency of q2 response 
zeta_2 = 0.0545;   % zeta for q2 response
q2_wn = q2_wd/(sqrt(1-zeta_2^2)) %  [rad/s] natural frequency for q2 response

% file name for q1
file_name_q1 = 'C:\Users\Henry\Desktop\Skripsie\Feedback-Control-of-Robotic-Gymnast-MCU\q1_response1.csv';
% file name for q2
file_name_q2 = 'C:\Users\Henry\Desktop\Skripsie\Feedback-Control-of-Robotic-Gymnast-MCU\q2_response2.csv';

% time increments
time_steps = 1e-3;

% response information
system_info_q1 = csvread(file_name_q1,2);
system_info_q2 = csvread(file_name_q2,2);

% time for q1
time_q1 = system_info_q1(1:end,1)./1000;
% time for q2
time_q2 = system_info_q2(1:end,1)./1000;

% q1 response
q1 = (system_info_q1(1:end,2)-2195).*0.00153;

% q2 response
q2 = system_info_q2(1:end,3).*0.01570796326/2;

tau = system_info_q1(1:end,4);

% three point central difference
q1dot = cent_diff_n(q1,time_steps,3);
q2dot = cent_diff_n(q2,time_steps,3);
q1dotdot = cent_diff_n(q1dot,time_steps,3);
q2dotdot = cent_diff_n(q2dot,time_steps,3);

%% Data Cleaning
% Removing points outside boundary:
i = find(q1(:,1) > 0.6*pi);
j = find(q1(:,1) < -0.6*pi);
q1(i) = 0;
q1(j) = 0;

% Removing points outside boundary:
i = find(q2(:,1) > 2*pi);
j = find(q2(:,1) < -2*pi);
q2(i) = 0;
q2(j) = 0;

% smoothing function to remove any noise
q1 = smooth(q1);
q2 = smooth(q2);


%% q1 response
figure(1);
plot(time_q1,q1,'.r');
title('System Response from Initial Conditions with $\phi = 0 $ ','Interpreter','latex','FontSize',12)
yticks([-2*pi -pi 0 pi 2*pi]);
ylabel('$\theta$ [rad]','Interpreter','latex','FontSize',12);
xlabel('time [ms]','Interpreter','latex','FontSize',12);
yticklabels({'-1.5\pi','-\pi','-0.5\pi','0','0.5\pi','\pi','1.5\pi'})
yticks([-1.5*pi -1*pi -0.5*pi 0 0.5*pi 1*pi 1.5*pi]);
grid on
xt = get(gca, 'XTick');
set(gca, 'FontSize', 12);
yt = get(gca, 'YTick');
set(gca, 'FontSize', 12);
hold on

disp('Click on starting point and steady state point');
[xx,yy] = ginput(2);



time_q1 = linspace(xx(1),xx(2),1000);
approximate_response = -yy(1)*exp(-1.*zeta_1.*q1_wn.*time_q1).*(cos(q1_wd.*time_q1));

plot(time_q1, approximate_response,'-b','LineWidth',1);
% hold on
% plot(time_q1.*1000, -pi/2.*exp(-1*zeta_1*q1_wn*time_q1.*1000),'-g','LineWidth',2);
% legend('Expertimental Data', 'Approximated Response','Approximated Decay Function')
% 
% 
% % q2 response
% 
figure(2)
plot(time_q2.*1000,q2,'b.');
title('System Response from Initial Conditions with $\theta = 0 $ ','Interpreter','latex','FontSize',12)
yticks([-2*pi -pi 0 pi 2*pi]);
ylabel('$\phi$ [rad]','Interpreter','latex','FontSize',12);
xlabel('time [ms]','Interpreter','latex','FontSize',12);
yticklabels({'-1.5\pi','-\pi','-0.5\pi','0','0.5\pi','\pi','1.5\pi'})
yticks([-1.5*pi -1*pi -0.5*pi 0 0.5*pi 1*pi 1.5*pi]);
grid on
xt = get(gca, 'XTick');
set(gca, 'FontSize', 12);
yt = get(gca, 'YTick');
set(gca, 'FontSize', 12);
hold on

time_q2 = linspace(0,8,8000);
approximate_response = -pi/2.*exp(-1.*zeta_2.*q2_wn.*time_q2).*(cos(q2_wd.*time_q2));

plot(time_q2.*1000, approximate_response,'-r','LineWidth',1);

plot(time_q2.*1000, -pi/2.*exp(-1*zeta_2*q2_wn*time_q2),'-g','LineWidth',2);
legend('Expertimental Data', 'Approximated Response','Approximated Decay Function')
##### SOURCE END #####
--></body></html>